cmake_minimum_required(VERSION @CMAKE_VERSION@)
project (BoostExternal)
include(ExternalProject)

if(CMAKE_CXX_COMPILER_ID MATCHES "GNU")
  set(_toolset "gcc")
elseif(CMAKE_CXX_COMPILER_ID MATCHES ".*Clang")
  set(_toolset "clang")
elseif(CMAKE_CXX_COMPILER_ID MATCHES "Intel")
  set(_toolset "intel-linux")
endif()

set(INSTALL_LOCATION ${CMAKE_BINARY_DIR}/boost-lib)

set(_cxxargs "-fPIC -DBOOST_NO_AUTO_PTR -fvisibility=default")
set(_b2args cxxflags=${_cxxargs};cflags=-fPIC;threading=multi; toolset=${_toolset} --without-python;--prefix=${INSTALL_LOCATION})

ExternalProject_Add(boost
  PREFIX build
  GIT_REPOSITORY    https://github.com/boostorg/boost.git
  GIT_TAG           boost-1.78.0
  DOWNLOAD_NO_PROGRESS TRUE
  UPDATE_COMMAND ""
  CONFIGURE_COMMAND <SOURCE_DIR>/bootstrap.sh
  BUILD_COMMAND <SOURCE_DIR>/b2 -q ${_b2args}
  LOG_BUILD TRUE
  BUILD_IN_SOURCE TRUE
  INSTALL_COMMAND <SOURCE_DIR>/b2 -q install ${_b2args}
  LOG_INSTALL TRUE
)

unset(_b2args)
unset(_toolset)